{"ast":null,"code":"import _asyncToGenerator from \"D:/Laragon/www/Osem-Salmon-PRS/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nvar patientNRIC = window.location.pathname.split(\"/\").pop();\nimport getCollection from \"../composables/getCollection\";\nimport getUserAuth from '../composables/getUserAuth';\nimport editPatientDetails from \"@/components/editPatientDetails\";\nimport { db } from \"../firebase/config\";\nimport { addDoc, collection } from \"firebase/firestore\";\nimport { ref } from \"vue\";\nexport default {\n  name: 'patientRecord',\n  components: {\n    editPatientDetails: editPatientDetails\n  },\n  setup: function setup() {\n    var _getUserAuth = getUserAuth(),\n        userAuth = _getUserAuth.userAuth;\n\n    var date = ref('');\n    var remarks = ref('');\n    var docName = ref('');\n    var nric = ref('');\n    var illness = ref('');\n    var ailment = ref('');\n\n    var _getCollection = getCollection('visit', ['nric', '==', patientNRIC]),\n        visit = _getCollection.documents;\n\n    var _getCollection2 = getCollection('user', ['nric', '==', patientNRIC]),\n        user = _getCollection2.documents;\n\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var colRef;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                colRef = collection(db, 'visit');\n                _context.next = 3;\n                return addDoc(colRef, {\n                  date: date.value,\n                  docName: userAuth.value.email,\n                  remarks: remarks.value,\n                  nric: patientNRIC,\n                  illness: illness.value,\n                  ailment: ailment.value\n                });\n\n              case 3:\n                date.value = '';\n                docName.value = '';\n                remarks.value = '';\n                nric.value = '';\n                illness.value = '';\n                ailment.value = '';\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function handleSubmit() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    return {\n      visit: visit,\n      user: user,\n      handleSubmit: handleSubmit,\n      userAuth: userAuth,\n      date: date,\n      docName: docName,\n      remarks: remarks,\n      nric: nric,\n      illness: illness,\n      ailment: ailment\n    };\n  },\n  mounted: function mounted() {\n    if (localStorage.getItem('reloaded')) {\n      // The page was just reloaded. Clear the value from local storage\n      // so that it will reload the next time this page is visited.\n      localStorage.removeItem('reloaded');\n    } else {\n      // Set a flag so that we know not to reload the page twice.\n      localStorage.setItem('reloaded', '1');\n      location.reload();\n    }\n  }\n};","map":{"version":3,"sources":["D:\\Laragon\\www\\Osem-Salmon-PRS\\src\\views\\patientRecord.vue"],"names":[],"mappings":";;;;AA+HA,IAAI,WAAU,GAAI,MAAM,CAAC,QAAP,CAAgB,QAAhB,CAAyB,KAAzB,CAA+B,GAA/B,EAAoC,GAApC,EAAlB;AAEA,OAAO,aAAP,MAA0B,8BAA1B;AACA,OAAO,WAAP,MAAwB,4BAAxB;AACA,OAAO,kBAAP,MAA+B,iCAA/B;AAEA,SAAS,EAAT,QAAmB,oBAAnB;AACA,SAAS,MAAT,EAAiB,UAAjB,QAAmC,oBAAnC;AACA,SAAS,GAAT,QAAoB,KAApB;AAEA,eAAe;EACX,IAAI,EAAE,eADK;EAEX,UAAU,EAAE;IAAE,kBAAiB,EAAjB;EAAF,CAFD;EAGX,KAHW,mBAGH;IACJ,mBAAqB,WAAW,EAAhC;IAAA,IAAQ,QAAR,gBAAQ,QAAR;;IAEA,IAAM,IAAG,GAAI,GAAG,CAAC,EAAD,CAAhB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;IACA,IAAM,IAAG,GAAI,GAAG,CAAC,EAAD,CAAhB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;;IAEA,qBAA6B,aAAa,CACtC,OADsC,EAEtC,CAAC,MAAD,EAAS,IAAT,EAAe,WAAf,CAFsC,CAA1C;IAAA,IAAmB,KAAnB,kBAAQ,SAAR;;IAKA,sBAA4B,aAAa,CACrC,MADqC,EAErC,CAAC,MAAD,EAAS,IAAT,EAAe,WAAf,CAFqC,CAAzC;IAAA,IAAmB,IAAnB,mBAAQ,SAAR;;IAKA,IAAM,YAAW;MAAA,mEAAI;QAAA;QAAA;UAAA;YAAA;cAAA;gBACX,MADW,GACF,UAAU,CAAC,EAAD,EAAK,OAAL,CADR;gBAAA;gBAAA,OAGX,MAAM,CAAC,MAAD,EAAS;kBACjB,IAAI,EAAE,IAAI,CAAC,KADM;kBAEjB,OAAO,EAAE,QAAQ,CAAC,KAAT,CAAe,KAFP;kBAGjB,OAAO,EAAE,OAAO,CAAC,KAHA;kBAIjB,IAAI,EAAE,WAJW;kBAKjB,OAAO,EAAE,OAAO,CAAC,KALA;kBAMjB,OAAO,EAAE,OAAO,CAAC;gBANA,CAAT,CAHK;;cAAA;gBAYjB,IAAI,CAAC,KAAL,GAAa,EAAb;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;gBACA,IAAI,CAAC,KAAL,GAAa,EAAb;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;;cAjBiB;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAJ;;MAAA,gBAAX,YAAW;QAAA;MAAA;IAAA,GAAjB;;IAoBA,OAAO;MACH,KAAK,EAAL,KADG;MAEH,IAAI,EAAJ,IAFG;MAGH,YAAY,EAAZ,YAHG;MAIH,QAAQ,EAAR,QAJG;MAKH,IAAI,EAAJ,IALG;MAMH,OAAO,EAAP,OANG;MAOH,OAAO,EAAP,OAPG;MAQH,IAAI,EAAJ,IARG;MASH,OAAO,EAAP,OATG;MAUH,OAAO,EAAP;IAVG,CAAP;EAYH,CAvDU;EAyDX,OAzDW,qBAyDD;IACN,IAAI,YAAY,CAAC,OAAb,CAAqB,UAArB,CAAJ,EAAsC;MAClC;MACA;MACA,YAAY,CAAC,UAAb,CAAwB,UAAxB;IACJ,CAJA,MAIO;MACH;MACA,YAAY,CAAC,OAAb,CAAqB,UAArB,EAAiC,GAAjC;MACA,QAAQ,CAAC,MAAT;IACJ;EACJ;AAnEW,CAAf","sourcesContent":["<template>\r\n<div class=\"container-fluid\">\r\n    <div class=\"row\">\r\n        <div>\r\n            <table class=\"table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">Name</th>\r\n                        <th scope=\"col\">NRIC</th>\r\n                        <th scope=\"col\">Email</th>\r\n                        <th scope=\"col\">Contact</th>\r\n                        <th scope=\"col\">Note</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody class=\"table-group-divider\">\r\n                    <tr v-for=\"user in user\" :key=\"user.id\">\r\n                    <td>{{ user.fullname }}</td>\r\n                    <td>{{ user.nric }}</td>\r\n                    <td>{{ user.email }}</td>\r\n                    <td>{{ user.contact }}</td>\r\n                    <td>{{ user.address }}</td>\r\n                    <td>{{ user.note }}</td>\r\n                    <td>\r\n                    <button type=\"button\" class=\"btn btn-primary float-end\" data-bs-toggle=\"modal\" data-bs-target=\"#staticBackdrop\">\r\n                    <i class=\"bi bi-pencil-square\"></i>\r\n                    </button>\r\n                    </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n    <div class=\"row\">\r\n        <div>\r\n        <table class=\"table\">\r\n            <thead>\r\n                <tr>\r\n                    <th scope=\"col\">Date</th>\r\n                    <th scope=\"col\">Doctor</th>\r\n                    <th scope=\"col\">Illness</th>\r\n                    <th scope=\"col\">Ailment(s)</th>\r\n                    <th scope=\"col\">Remarks</th>\r\n                    <th>\r\n                        <button type=\"button\" class=\"btn btn-primary float-end\" data-bs-toggle=\"modal\" data-bs-target=\"#staticBackdrop2\">\r\n            <i class=\"bi bi-plus-square\"></i>\r\n            </button>\r\n                    </th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr v-for=\"visit in visit\" :key=\"visit.id\">\r\n                <td>{{ visit.date }}</td>\r\n                <td>{{ visit.docName }}</td>\r\n                <td>{{ visit.illness }}</td>\r\n                <td>{{ visit.ailment }}</td>\r\n                <td>{{ visit.remarks }}</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<!-- Modal -->\r\n<div class=\"modal fade\" id=\"staticBackdrop\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"staticBackdropLabel\">Edit Patient Details</h5>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <editPatientDetails />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"modal fade\" id=\"staticBackdrop2\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"staticBackdropLabel\">New Visitation Record</h5>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <form @submit.prevent=\"handleSubmit\">\r\n            <div class=\"form-floating mb-3\">\r\n                <input class=\"form-control\" type=\"date\" name=\"date\" v-model=\"date\" placeholder=\"date\" required />\r\n                <label for=\"date\" class=\"form-label\">Date</label>\r\n            </div>\r\n\r\n            <div class=\"form-floating mb-3\">\r\n                <input class=\"form-control\" type=\"text\" name=\"docName\" v-model=\"userAuth.email\" required readonly />\r\n                <label for=\"docName\" class=\"form-label\">Doctor</label>\r\n            </div>\r\n\r\n            <div class=\"form-floating mb-3\">\r\n                <input class=\"form-control\" type=\"text\" name=\"illness\" v-model=\"illness\" placeholder=\"Illness\" required />\r\n                <label for=\"illness\" class=\"form-label\">Illness</label>\r\n            </div>\r\n\r\n            <div class=\"form-floating mb-3\">\r\n                <input class=\"form-control\" type=\"text\" name=\"ailment\" v-model=\"ailment\" placeholder=\"Ailment\" required />\r\n                <label for=\"ailment\" class=\"form-label\">Ailment(s)</label>\r\n            </div>\r\n\r\n            <div class=\"form-floating mb-3\">\r\n                <textarea class=\"form-control\" name=\"remarks\" v-model=\"remarks\" placeholder=\"remarks\" required></textarea>\r\n                <label for=\"remarks\" class=\"form-label\">Remarks</label>\r\n            </div>\r\n            \r\n            \r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\r\n                <button class=\"btn btn-primary\">Add New Record</button>\r\n            </div>\r\n        </form>\r\n      </div>\r\n      \r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n</template>\r\n\r\n<script>\r\nvar patientNRIC = window.location.pathname.split(\"/\").pop()\r\n\r\nimport getCollection from \"../composables/getCollection\"\r\nimport getUserAuth from '../composables/getUserAuth'\r\nimport editPatientDetails from \"@/components/editPatientDetails\"\r\n\r\nimport { db } from \"../firebase/config\"\r\nimport { addDoc, collection } from \"firebase/firestore\"\r\nimport { ref } from \"vue\"\r\n\r\nexport default {\r\n    name: 'patientRecord',\r\n    components: { editPatientDetails },\r\n    setup() {\r\n        const { userAuth } = getUserAuth()\r\n\r\n        const date = ref('')\r\n        const remarks = ref('')\r\n        const docName = ref('')\r\n        const nric = ref('')\r\n        const illness = ref('')\r\n        const ailment = ref('')\r\n\r\n        const { documents: visit } = getCollection(\r\n            'visit',\r\n            ['nric', '==', patientNRIC]\r\n            )\r\n\r\n        const { documents: user } = getCollection(\r\n            'user',\r\n            ['nric', '==', patientNRIC]\r\n            )\r\n\r\n        const handleSubmit = async () => {\r\n            const colRef = collection(db, 'visit')\r\n\r\n            await addDoc(colRef, {\r\n                date: date.value,\r\n                docName: userAuth.value.email,\r\n                remarks: remarks.value,\r\n                nric: patientNRIC,\r\n                illness: illness.value,\r\n                ailment: ailment.value,\r\n            })\r\n\r\n            date.value = ''\r\n            docName.value = ''\r\n            remarks.value = ''\r\n            nric.value = ''\r\n            illness.value = ''\r\n            ailment.value = ''\r\n        }\r\n\r\n        return { \r\n            visit,\r\n            user,\r\n            handleSubmit,\r\n            userAuth,\r\n            date,\r\n            docName,\r\n            remarks,\r\n            nric,\r\n            illness,\r\n            ailment,\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        if (localStorage.getItem('reloaded')) {\r\n            // The page was just reloaded. Clear the value from local storage\r\n            // so that it will reload the next time this page is visited.\r\n            localStorage.removeItem('reloaded');\r\n        } else {\r\n            // Set a flag so that we know not to reload the page twice.\r\n            localStorage.setItem('reloaded', '1');\r\n            location.reload();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style>\r\n</style>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}