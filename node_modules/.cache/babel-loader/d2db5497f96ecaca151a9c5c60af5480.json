{"ast":null,"code":"import _asyncToGenerator from \"D:/Laragon/www/Osem-Salmon-PRS/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nvar patientNRIC = window.location.pathname.split(\"/\").pop(); //console.log(patientNRIC)\n\nimport getCollection from \"../composables/getCollection\";\nimport getUserAuth from '../composables/getUserAuth';\nimport { db } from \"../firebase/config\";\nimport { addDoc, collection } from \"firebase/firestore\";\nimport { ref } from \"vue\";\nexport default {\n  setup: function setup() {\n    var _getUserAuth = getUserAuth(),\n        userAuth = _getUserAuth.userAuth;\n\n    var currentDoc = userAuth.value.email;\n    var date = ref('');\n    var docNote = ref('');\n    var docName = ref('');\n    var nric = ref('');\n\n    var _getCollection = getCollection('visit', ['nric', '==', patientNRIC]),\n        visit = _getCollection.documents;\n\n    var _getCollection2 = getCollection('user', ['nric', '==', patientNRIC]),\n        user = _getCollection2.documents;\n\n    var handleSubmit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var colRef;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                colRef = collection(db, 'visit');\n                _context.next = 3;\n                return addDoc(colRef, {\n                  date: date.value,\n                  docName: currentDoc,\n                  docNote: docNote.value,\n                  nric: patientNRIC\n                });\n\n              case 3:\n                date.value = '';\n                docName.value = '';\n                docNote.value = '';\n                nric.value = '';\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function handleSubmit() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    return {\n      visit: visit,\n      user: user,\n      handleSubmit: handleSubmit,\n      userAuth: userAuth,\n      date: date,\n      docName: docName,\n      docNote: docNote,\n      nric: nric\n    };\n  },\n  mounted: function mounted() {\n    if (localStorage.getItem('reloaded')) {\n      // The page was just reloaded. Clear the value from local storage\n      // so that it will reload the next time this page is visited.\n      localStorage.removeItem('reloaded');\n    } else {\n      // Set a flag so that we know not to reload the page twice.\n      localStorage.setItem('reloaded', '1');\n      location.reload();\n    }\n  }\n};","map":{"version":3,"sources":["D:\\Laragon\\www\\Osem-Salmon-PRS\\src\\views\\patientRecord.vue"],"names":[],"mappings":";;;;AAiEA,IAAI,WAAU,GAAI,MAAM,CAAC,QAAP,CAAgB,QAAhB,CAAyB,KAAzB,CAA+B,GAA/B,EAAoC,GAApC,EAAlB,C,CAEA;;AAEA,OAAO,aAAP,MAA0B,8BAA1B;AACA,OAAO,WAAP,MAAwB,4BAAxB;AAEA,SAAS,EAAT,QAAmB,oBAAnB;AACA,SAAS,MAAT,EAAiB,UAAjB,QAAmC,oBAAnC;AACA,SAAS,GAAT,QAAoB,KAApB;AAEA,eAAe;EACX,KADW,mBACH;IACJ,mBAAqB,WAAW,EAAhC;IAAA,IAAQ,QAAR,gBAAQ,QAAR;;IAEA,IAAI,UAAS,GAAI,QAAQ,CAAC,KAAT,CAAe,KAAhC;IAEA,IAAM,IAAG,GAAI,GAAG,CAAC,EAAD,CAAhB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;IACA,IAAM,OAAM,GAAI,GAAG,CAAC,EAAD,CAAnB;IACA,IAAM,IAAG,GAAI,GAAG,CAAC,EAAD,CAAhB;;IAEA,qBAA6B,aAAa,CACtC,OADsC,EAEtC,CAAC,MAAD,EAAS,IAAT,EAAe,WAAf,CAFsC,CAA1C;IAAA,IAAmB,KAAnB,kBAAQ,SAAR;;IAKA,sBAA4B,aAAa,CACrC,MADqC,EAErC,CAAC,MAAD,EAAS,IAAT,EAAe,WAAf,CAFqC,CAAzC;IAAA,IAAmB,IAAnB,mBAAQ,SAAR;;IAKA,IAAM,YAAW;MAAA,mEAAI;QAAA;QAAA;UAAA;YAAA;cAAA;gBACX,MADW,GACF,UAAU,CAAC,EAAD,EAAK,OAAL,CADR;gBAAA;gBAAA,OAGX,MAAM,CAAC,MAAD,EAAS;kBACjB,IAAI,EAAE,IAAI,CAAC,KADM;kBAEjB,OAAO,EAAE,UAFQ;kBAGjB,OAAO,EAAE,OAAO,CAAC,KAHA;kBAIjB,IAAI,EAAE;gBAJW,CAAT,CAHK;;cAAA;gBAUjB,IAAI,CAAC,KAAL,GAAa,EAAb;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;gBACA,OAAO,CAAC,KAAR,GAAgB,EAAhB;gBACA,IAAI,CAAC,KAAL,GAAa,EAAb;;cAbiB;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAJ;;MAAA,gBAAX,YAAW;QAAA;MAAA;IAAA,GAAjB;;IAgBA,OAAO;MACH,KAAK,EAAL,KADG;MAEH,IAAI,EAAJ,IAFG;MAGH,YAAY,EAAZ,YAHG;MAIH,QAAQ,EAAR,QAJG;MAKH,IAAI,EAAJ,IALG;MAMH,OAAO,EAAP,OANG;MAOH,OAAO,EAAP,OAPG;MAQH,IAAG,EAAH;IARG,CAAP;EAUH,CA/CU;EAiDX,OAjDW,qBAiDD;IACN,IAAI,YAAY,CAAC,OAAb,CAAqB,UAArB,CAAJ,EAAsC;MAClC;MACA;MACA,YAAY,CAAC,UAAb,CAAwB,UAAxB;IACJ,CAJA,MAIO;MACH;MACA,YAAY,CAAC,OAAb,CAAqB,UAArB,EAAiC,GAAjC;MACA,QAAQ,CAAC,MAAT;IACJ;EACJ;AA3DW,CAAf","sourcesContent":["<template>\r\n    <ul class=\"list-group\">\r\n        <li class=\"list-group-item list-group-item-dark\" v-for=\"user in user\" :key=\"user.id\">\r\n            <div class=\"details\">\r\n                <span class=\"fs-2 fw-bold\">{{ user.fullname }}</span> \r\n                <span class=\"fs-3 fw-light ms-3\">{{ user.nric }}</span>\r\n                <br>\r\n                <span class=\"fs-4 fw-light\">{{ user.dob }}</span> \r\n                <span class=\"fs-4 fw-light ms-3\">{{ user.email }}</span>\r\n                \r\n            </div>\r\n        </li>\r\n    </ul>\r\n\r\n    <div class=\"accordion mt-1 mb-1\">\r\n        <div class=\"accordion-item\">\r\n            <h2 class=\"accordion-header\" id=\"headingTwo\">\r\n            <button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#collapseTwo\" aria-expanded=\"false\" aria-controls=\"collapseTwo\">\r\n                Add Record\r\n            </button>\r\n            </h2>\r\n            <div id=\"collapseTwo\" class=\"accordion-collapse collapse container\" aria-labelledby=\"headingTwo\" data-bs-parent=\"#accordionExample\">\r\n                <div class=\"accordion-body\">\r\n                    <form @submit.prevent=\"handleSubmit\">\r\n                        <div class=\"form-floating mb-3\">\r\n                            <input class=\"form-control\" type=\"date\" name=\"date\" v-model=\"date\" placeholder=\"date\" required />\r\n                            <label for=\"date\" class=\"form-label\">Date</label>\r\n                        </div>\r\n\r\n                        <div class=\"form-floating mb-3\">\r\n                            <input class=\"form-control\" type=\"text\" name=\"docName\" v-model=\"userAuth.email\" required readonly />\r\n                            <label for=\"docName\" class=\"form-label\">Doctor</label>\r\n                        </div>\r\n\r\n                        <div class=\"form-floating mb-3\">\r\n                            <textarea class=\"form-control\" name=\"docNote\" v-model=\"docNote\" placeholder=\"Note\" required></textarea>\r\n                            <label for=\"docNote\" class=\"form-label\">Note</label>\r\n                        </div>\r\n                        <br>\r\n                        \r\n                        <div clas=\"form-floating mb-3\">\r\n                            <button class=\"btn btn-outline-success\">Add Record</button>\r\n                        </div>\r\n                        \r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <ul class=\"list-group\">\r\n        <li class=\"list-group-item list-group-item-light\" v-for=\"visit in visit\" :key=\"visit.id\">\r\n            <div class=\"details\">\r\n                <span class=\"fw-semibold\">Date:</span> <span class=\"fw-light\">{{ visit.date }}</span>\r\n                <br>\r\n                <span class=\"fw-semibold\">Note:</span> <span class=\"fw-light\">{{ visit.docNote }}</span>\r\n                <br>\r\n                <span class=\"fw-semibold\">Doctor:</span> <span class=\"fw-light\">{{ visit.docName }}</span>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</template>\r\n\r\n<script>\r\nvar patientNRIC = window.location.pathname.split(\"/\").pop()\r\n \r\n//console.log(patientNRIC)\r\n\r\nimport getCollection from \"../composables/getCollection\"\r\nimport getUserAuth from '../composables/getUserAuth'\r\n\r\nimport { db } from \"../firebase/config\"\r\nimport { addDoc, collection } from \"firebase/firestore\"\r\nimport { ref } from \"vue\"\r\n\r\nexport default {\r\n    setup() {\r\n        const { userAuth } = getUserAuth()\r\n\r\n        var currentDoc = userAuth.value.email\r\n\r\n        const date = ref('')\r\n        const docNote = ref('')\r\n        const docName = ref('')\r\n        const nric = ref('')\r\n\r\n        const { documents: visit } = getCollection(\r\n            'visit',\r\n            ['nric', '==', patientNRIC]\r\n            )\r\n\r\n        const { documents: user } = getCollection(\r\n            'user',\r\n            ['nric', '==', patientNRIC]\r\n            )\r\n\r\n        const handleSubmit = async () => {\r\n            const colRef = collection(db, 'visit')\r\n\r\n            await addDoc(colRef, {\r\n                date: date.value,\r\n                docName: currentDoc,\r\n                docNote: docNote.value,\r\n                nric: patientNRIC\r\n            })\r\n\r\n            date.value = ''\r\n            docName.value = ''\r\n            docNote.value = ''\r\n            nric.value = ''\r\n        }\r\n\r\n        return { \r\n            visit,\r\n            user,\r\n            handleSubmit,\r\n            userAuth,\r\n            date,\r\n            docName,\r\n            docNote,\r\n            nric \r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        if (localStorage.getItem('reloaded')) {\r\n            // The page was just reloaded. Clear the value from local storage\r\n            // so that it will reload the next time this page is visited.\r\n            localStorage.removeItem('reloaded');\r\n        } else {\r\n            // Set a flag so that we know not to reload the page twice.\r\n            localStorage.setItem('reloaded', '1');\r\n            location.reload();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}