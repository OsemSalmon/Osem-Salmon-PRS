{"ast":null,"code":"import _asyncToGenerator from \"D:/Laragon/www/Osem-Salmon-PRS/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport { getDownloadURL, uploadBytesResumable } from 'firebase/storage';\nimport { ref } from 'vue';\nimport { projectStorage } from \"../firebase/config\";\nimport getUserAuth from './getUserAuth';\n\nvar _getUserAuth = getUserAuth(),\n    userAuth = _getUserAuth.userAuth;\n\nvar useStorage = function useStorage() {\n  var error = ref(null);\n  var url = ref(null);\n  var filePath = ref(null);\n\n  uploadImage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(file) {\n      var storageRef, uploadTask, url;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              filePath.value = \"covers/\".concat(userAuth.value.uid, \"/\").concat(file.name);\n              storageRef = ref(projectStorage, \"covers/\".concat(userAuth.value.uid, \"/\").concat(file.name));\n              uploadTask = uploadBytesResumable(storageRef, file);\n              uploadTask.on('state_changed', function (snapshot) {\n                var percentage = (snapshot.bytesTransferred / snapshot.totalBytes * 100).toFixed(0) + '%';\n                console.log(percentage);\n              });\n              _context.next = 6;\n              return uploadTask;\n\n            case 6:\n              _context.next = 8;\n              return getDownloadURL(storageRef);\n\n            case 8:\n              url = _context.sent;\n              console.log(url);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function uploadImage(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return {\n    error: error,\n    url: url,\n    filePath: filePath,\n    uploadImage: uploadImage\n  };\n};\n\nexport default useStorage;","map":{"version":3,"names":["getDownloadURL","uploadBytesResumable","ref","projectStorage","getUserAuth","userAuth","useStorage","error","url","filePath","uploadImage","file","value","uid","name","storageRef","uploadTask","on","snapshot","percentage","bytesTransferred","totalBytes","toFixed","console","log"],"sources":["D:/Laragon/www/Osem-Salmon-PRS/src/composables/useStorage.js"],"sourcesContent":["import { getDownloadURL, uploadBytesResumable } from 'firebase/storage'\r\nimport { ref } from 'vue'\r\nimport { projectStorage } from \"../firebase/config\"\r\nimport getUserAuth from './getUserAuth'\r\n\r\nconst { userAuth } = getUserAuth()\r\nconst useStorage = () => {\r\n    const error = ref(null)\r\n    const url = ref(null)\r\n    const filePath = ref(null)\r\n\r\n    uploadImage = async (file) => {\r\n        filePath.value = `covers/${userAuth.value.uid}/${file.name}`\r\n        const storageRef = ref(projectStorage, `covers/${userAuth.value.uid}/${file.name}`)\r\n        const uploadTask =  uploadBytesResumable(storageRef, file)\r\n        uploadTask.on('state_changed', snapshot => {\r\n            const percentage = ((snapshot.bytesTransferred / snapshot.totalBytes) * 100).toFixed(0) + '%'\r\n            console.log(percentage)\r\n        })\r\n\r\n        await uploadTask\r\n        const url = await getDownloadURL(storageRef)\r\n        console.log(url)\r\n    }\r\n\r\n    return {\r\n        error, url, filePath, uploadImage\r\n    }\r\n}\r\n\r\nexport default useStorage"],"mappings":";;;;;AAAA,SAASA,cAAT,EAAyBC,oBAAzB,QAAqD,kBAArD;AACA,SAASC,GAAT,QAAoB,KAApB;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,OAAOC,WAAP,MAAwB,eAAxB;;AAEA,mBAAqBA,WAAW,EAAhC;AAAA,IAAQC,QAAR,gBAAQA,QAAR;;AACA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;EACrB,IAAMC,KAAK,GAAGL,GAAG,CAAC,IAAD,CAAjB;EACA,IAAMM,GAAG,GAAGN,GAAG,CAAC,IAAD,CAAf;EACA,IAAMO,QAAQ,GAAGP,GAAG,CAAC,IAAD,CAApB;;EAEAQ,WAAW;IAAA,mEAAG,iBAAOC,IAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cACVF,QAAQ,CAACG,KAAT,oBAA2BP,QAAQ,CAACO,KAAT,CAAeC,GAA1C,cAAiDF,IAAI,CAACG,IAAtD;cACMC,UAFI,GAESb,GAAG,CAACC,cAAD,mBAA2BE,QAAQ,CAACO,KAAT,CAAeC,GAA1C,cAAiDF,IAAI,CAACG,IAAtD,EAFZ;cAGJE,UAHI,GAGUf,oBAAoB,CAACc,UAAD,EAAaJ,IAAb,CAH9B;cAIVK,UAAU,CAACC,EAAX,CAAc,eAAd,EAA+B,UAAAC,QAAQ,EAAI;gBACvC,IAAMC,UAAU,GAAG,CAAED,QAAQ,CAACE,gBAAT,GAA4BF,QAAQ,CAACG,UAAtC,GAAoD,GAArD,EAA0DC,OAA1D,CAAkE,CAAlE,IAAuE,GAA1F;gBACAC,OAAO,CAACC,GAAR,CAAYL,UAAZ;cACH,CAHD;cAJU;cAAA,OASJH,UATI;;YAAA;cAAA;cAAA,OAUQhB,cAAc,CAACe,UAAD,CAVtB;;YAAA;cAUJP,GAVI;cAWVe,OAAO,CAACC,GAAR,CAAYhB,GAAZ;;YAXU;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA;MAAA;IAAA;EAAA,GAAX;;EAcA,OAAO;IACHD,KAAK,EAALA,KADG;IACIC,GAAG,EAAHA,GADJ;IACSC,QAAQ,EAARA,QADT;IACmBC,WAAW,EAAXA;EADnB,CAAP;AAGH,CAtBD;;AAwBA,eAAeJ,UAAf"},"metadata":{},"sourceType":"module"}