{"ast":null,"code":"import _asyncToGenerator from \"D:/Laragon/www/Osem-Salmon-PRS/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport { getDownloadURL, getStorage, uploadBytes } from 'firebase/storage';\nimport { ref } from 'vue';\nimport { storage } from '../firebase/config';\nimport getUserAuth from './getUserAuth';\n\nvar _getUserAuth = getUserAuth(),\n    userAuth = _getUserAuth.userAuth;\n\nvar useStorage = function useStorage() {\n  var error = ref(null);\n  var url = ref(null);\n  var filePath = ref(null);\n\n  var uploadImage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(file) {\n      var res;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              error.value = null;\n              filePath.value = null;\n              _context.prev = 2;\n              _context.next = 5;\n              return uploadBytes(storage, file, userAuth.value.uid);\n\n            case 5:\n              res = _context.sent;\n\n              if (res) {\n                _context.next = 8;\n                break;\n              }\n\n              throw new Error('Upload failed');\n\n            case 8:\n              filePath.value = res.fullPath;\n              error.value = null;\n              _context.next = 16;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0.message);\n              error.value = _context.t0.message;\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 12]]);\n    }));\n\n    return function uploadImage(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return {\n    error: error,\n    url: url,\n    filePath: filePath,\n    uploadImage: uploadImage\n  };\n};\n\nexport default useStorage;","map":{"version":3,"names":["getDownloadURL","getStorage","uploadBytes","ref","storage","getUserAuth","userAuth","useStorage","error","url","filePath","uploadImage","file","value","uid","res","Error","fullPath","console","log","message"],"sources":["D:/Laragon/www/Osem-Salmon-PRS/src/composables/useStorage.js"],"sourcesContent":["import { getDownloadURL, getStorage, uploadBytes } from 'firebase/storage'\r\nimport { ref } from 'vue'\r\nimport { storage } from '../firebase/config'\r\nimport getUserAuth from './getUserAuth'\r\n\r\nconst { userAuth } = getUserAuth()\r\n\r\nconst useStorage = () => {\r\n    const error = ref(null)\r\n    const url = ref(null)\r\n    const filePath = ref(null)\r\n\r\n    const uploadImage = async (file) => {\r\n        error.value = null\r\n        filePath.value = null\r\n\r\n        try {\r\n            const res = await uploadBytes(storage, file, userAuth.value.uid)\r\n            if(!res) {\r\n                throw new Error('Upload failed')\r\n            }\r\n\r\n            filePath.value = res.fullPath\r\n            error.value = null\r\n        }\r\n        catch (err) {\r\n            console.log(err.message)\r\n            error.value = err.message\r\n        }\r\n    }\r\n\r\n    return {\r\n        error, url, filePath, uploadImage\r\n    }\r\n}\r\n\r\nexport default useStorage"],"mappings":";;AAAA,SAASA,cAAT,EAAyBC,UAAzB,EAAqCC,WAArC,QAAwD,kBAAxD;AACA,SAASC,GAAT,QAAoB,KAApB;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,OAAOC,WAAP,MAAwB,eAAxB;;AAEA,mBAAqBA,WAAW,EAAhC;AAAA,IAAQC,QAAR,gBAAQA,QAAR;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;EACrB,IAAMC,KAAK,GAAGL,GAAG,CAAC,IAAD,CAAjB;EACA,IAAMM,GAAG,GAAGN,GAAG,CAAC,IAAD,CAAf;EACA,IAAMO,QAAQ,GAAGP,GAAG,CAAC,IAAD,CAApB;;EAEA,IAAMQ,WAAW;IAAA,mEAAG,iBAAOC,IAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cAChBJ,KAAK,CAACK,KAAN,GAAc,IAAd;cACAH,QAAQ,CAACG,KAAT,GAAiB,IAAjB;cAFgB;cAAA;cAAA,OAKMX,WAAW,CAACE,OAAD,EAAUQ,IAAV,EAAgBN,QAAQ,CAACO,KAAT,CAAeC,GAA/B,CALjB;;YAAA;cAKNC,GALM;;cAAA,IAMRA,GANQ;gBAAA;gBAAA;cAAA;;cAAA,MAOF,IAAIC,KAAJ,CAAU,eAAV,CAPE;;YAAA;cAUZN,QAAQ,CAACG,KAAT,GAAiBE,GAAG,CAACE,QAArB;cACAT,KAAK,CAACK,KAAN,GAAc,IAAd;cAXY;cAAA;;YAAA;cAAA;cAAA;cAcZK,OAAO,CAACC,GAAR,CAAY,YAAIC,OAAhB;cACAZ,KAAK,CAACK,KAAN,GAAc,YAAIO,OAAlB;;YAfY;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA,gBAAXT,WAAW;MAAA;IAAA;EAAA,GAAjB;;EAmBA,OAAO;IACHH,KAAK,EAALA,KADG;IACIC,GAAG,EAAHA,GADJ;IACSC,QAAQ,EAARA,QADT;IACmBC,WAAW,EAAXA;EADnB,CAAP;AAGH,CA3BD;;AA6BA,eAAeJ,UAAf"},"metadata":{},"sourceType":"module"}