{"ast":null,"code":"import CreateUserForm from \"@/components/CreateUserForm\";\nimport getCollection from \"../composables/getCollection\";\nimport getUserAuth from \"../composables/getUserAuth\";\nimport { db } from \"../firebase/config\";\nimport { doc, deleteDoc, updateDoc } from \"firebase/firestore\";\nexport default {\n  name: \"Home\",\n  components: {\n    CreateUserForm\n  },\n\n  setup() {\n    const {\n      userAuth\n    } = getUserAuth(); //get user info from collection\n\n    const {\n      documents: user\n    } = getCollection(\"user\");\n    const {\n      documents: staff\n    } = getCollection(\"staff\", ['email', '==', userAuth.value.email]); //delete user from collection\n\n    const handleDelete = user => {\n      const docRef = doc(db, \"user\", user.id);\n      deleteDoc(docRef);\n    }; //update user info\n\n\n    const handleUpdate = staff => {\n      const docRef = doc(db, \"staff\", staff.id);\n      updateDoc(docRef, {\n        uid: userAuth.value.uid\n      });\n    };\n\n    return {\n      user,\n      handleDelete,\n      userAuth,\n      staff,\n      handleUpdate\n    };\n  }\n\n};","map":{"version":3,"sources":["D:\\Laragon\\www\\Osem-Salmon-PRS\\src\\views\\Home.vue"],"names":[],"mappings":"AA2EA,OAAO,cAAP,MAA2B,6BAA3B;AACA,OAAO,aAAP,MAA0B,8BAA1B;AACA,OAAO,WAAP,MAAwB,4BAAxB;AAEA,SAAS,EAAT,QAAmB,oBAAnB;AACA,SAAS,GAAT,EAAc,SAAd,EAAyB,SAAzB,QAA0C,oBAA1C;AAEA,eAAe;EACb,IAAI,EAAE,MADO;EAEb,UAAU,EAAE;IAAE;EAAF,CAFC;;EAGb,KAAK,GAAG;IAEN,MAAM;MAAE;IAAF,IAAe,WAAW,EAAhC,CAFM,CAGN;;IACA,MAAM;MAAE,SAAS,EAAE;IAAb,IAAsB,aAAa,CAAC,MAAD,CAAzC;IAEA,MAAM;MAAE,SAAS,EAAE;IAAb,IAAuB,aAAa,CAAC,OAAD,EAC1C,CAAC,OAAD,EAAU,IAAV,EAAgB,QAAQ,CAAC,KAAT,CAAe,KAA/B,CAD0C,CAA1C,CANM,CASN;;IACA,MAAM,YAAW,GAAK,IAAD,IAAU;MAC7B,MAAM,MAAK,GAAI,GAAG,CAAC,EAAD,EAAK,MAAL,EAAa,IAAI,CAAC,EAAlB,CAAlB;MAEA,SAAS,CAAC,MAAD,CAAT;IACF,CAJA,CAVM,CAgBN;;;IACA,MAAM,YAAW,GAAK,KAAD,IAAW;MAC9B,MAAM,MAAK,GAAI,GAAG,CAAC,EAAD,EAAK,OAAL,EAAc,KAAK,CAAC,EAApB,CAAlB;MACA,SAAS,CAAC,MAAD,EAAS;QAChB,GAAG,EAAE,QAAQ,CAAC,KAAT,CAAe;MADJ,CAAT,CAAT;IAGF,CALA;;IAOA,OAAO;MAAE,IAAF;MAAQ,YAAR;MAAsB,QAAtB;MAAgC,KAAhC;MAAuC;IAAvC,CAAP;EACF;;AA5Ba,CAAf","sourcesContent":["<template>\n<div class=\"container-fluid\">\n  \n  <div class=\"row\">\n    \n    <div class=\"m-3\">\n      <button type=\"button\" class=\"btn btn-primary float-end me-4\" data-bs-toggle=\"modal\" data-bs-target=\"#staticBackdrop\">\n      <i class=\"bi bi-plus-square\"></i>\n      </button>\n      <div v-for=\"staff in staff\" :key=\"staff.id\">\n        <form @submit.prevent=\"handleUpdate(staff)\">\n        <button class=\"btn btn-outline-dark float-end me-3\"><i class=\"bi bi-arrow-repeat\"></i></button>\n        </form>\n      </div>\n      \n    </div>\n\n    <!-- Modal -->\n    <div class=\"modal fade\" id=\"staticBackdrop\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id=\"staticBackdropLabel\">New Patient Registration</h5>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <CreateUserForm/>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n  <div class=\"row\">\n    \n    <table class=\"table table-striped table-hover table-bordered\">\n      <thead>\n        <tr>\n          <th scope=\"col\">Name</th>\n          <th scope=\"col\">NRIC</th>\n          <th scope=\"col\">Email</th>\n          <th scope=\"col\">Contact</th>\n          <th scope=\"col\">Address</th>\n          <th scope=\"col\" colspan=\"2\">Action</th>\n        </tr>\n      </thead>\n      <tbody class=\"table-group-divider\">\n        <tr v-for=\"user in user\" :key=\"user.id\">\n        <td>{{ user.fullname }}</td>\n        <td>{{ user.nric }}</td>\n        <td>{{ user.email }}</td>\n        <td>{{ user.contact }}</td>\n        <td>{{ user.address }}</td>\n        <td>\n          <router-link :to=\"`/patientRecord/${user.nric}`\" style=\"color: black\">\n            <i id=\"editUser\" class=\"bi bi-pencil-square\"></i>\n          </router-link>\n        </td>\n        <td><i id=\"deleteUser\" class=\"bi bi-person-dash-fill\" @click=\"handleDelete(user)\"></i></td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n<div v-for=\"staff in staff\" :key=\"staff.id\">\n<div v-if=\"!staff.isApproved\">\n<head>\n  <meta http-equiv = \"refresh\" content = \"0; url = /accessDenied\" />\n</head>\n</div>\n</div>\n\n</template>\n\n<script>\nimport CreateUserForm from \"@/components/CreateUserForm\"\nimport getCollection from \"../composables/getCollection\"\nimport getUserAuth from \"../composables/getUserAuth\"\n\nimport { db } from \"../firebase/config\"\nimport { doc, deleteDoc, updateDoc } from \"firebase/firestore\"\n\nexport default {\n  name: \"Home\",\n  components: { CreateUserForm },\n  setup() {\n\n    const { userAuth } = getUserAuth()\n    //get user info from collection\n    const { documents: user } = getCollection(\"user\")\n\n    const { documents: staff } = getCollection(\"staff\",\n    ['email', '==', userAuth.value.email])\n\n    //delete user from collection\n    const handleDelete = (user) => {\n      const docRef = doc(db, \"user\", user.id)\n\n      deleteDoc(docRef)\n    }\n\n    //update user info\n    const handleUpdate = (staff) => {\n      const docRef = doc(db, \"staff\", staff.id)\n      updateDoc(docRef, {\n        uid: userAuth.value.uid\n      })\n    }\n\n    return { user, handleDelete, userAuth, staff, handleUpdate }\n  }\n}\n</script>\n\n<style>\n/* .home ul {\n  padding: 0;\n}\n.home li {\n  list-style-type: none;\n  background: #fff;\n  padding: 10px;\n  border-radius: 6px;\n  margin-bottom: 12px;\n  display: flex;\n}\n.home li .details {\n  margin-right: auto;\n}\n.home li h3 {\n  margin: 0;\n  margin-bottom: 4px;\n}\n\n.home li p {\n  margin: 0;\n}\n\n.icon {\n  color: black;\n}\n*/\n#deleteUser:hover {\n  color: red;\n}\n\n#editUser:hover {\n  color: blue;\n} \n</style>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}