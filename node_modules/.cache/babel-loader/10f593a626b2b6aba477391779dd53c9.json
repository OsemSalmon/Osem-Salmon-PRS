{"ast":null,"code":"import { ref, watchEffect } from 'vue';\nimport { db } from '../firebase/config';\nimport { collection, onSnapshot, query, where } from 'firebase/firestore';\n\nconst getCollection = (c, q) => {\n  const documents = ref(null);\n  let colRef = collection(db, c);\n\n  if (q) {\n    colRef = query(colRef, where(...q));\n  }\n\n  const unsub = onSnapshot(colRef, snapshot => {\n    let results = [];\n    snapshot.docs.forEach(doc => {\n      results.push({ ...doc.data(),\n        id: doc.id\n      });\n    }); //update value\n\n    documents.value = results;\n  });\n  watchEffect(onInvalidate => {\n    onInvalidate(() => unsub());\n  });\n  return {\n    documents\n  };\n};\n\nexport default getCollection;","map":{"version":3,"names":["ref","watchEffect","db","collection","onSnapshot","query","where","getCollection","c","q","documents","colRef","unsub","snapshot","results","docs","forEach","doc","push","data","id","value","onInvalidate"],"sources":["D:/Laragon/www/Osem-Salmon-PRS/src/composables/getCollection.js"],"sourcesContent":["import { ref, watchEffect } from 'vue'\r\n\r\nimport { db } from '../firebase/config'\r\nimport { collection, onSnapshot, query, where } from 'firebase/firestore'\r\n\r\nconst getCollection = (c, q) => {\r\n    const documents = ref(null)\r\n\r\n    let colRef = collection(db, c)\r\n\r\n    if (q) {\r\n        colRef = query(colRef, where(...q))\r\n    }\r\n    \r\n    const unsub = onSnapshot(colRef, snapshot => {\r\n        let results = []\r\n        snapshot.docs.forEach(doc => {\r\n            results.push({ ...doc.data(), id: doc.id })\r\n        })\r\n\r\n        //update value\r\n        documents.value = results\r\n    })\r\n\r\n    watchEffect((onInvalidate) => {\r\n        onInvalidate(() => unsub())\r\n    })\r\n\r\n    return { documents }\r\n}\r\n\r\nexport default getCollection"],"mappings":"AAAA,SAASA,GAAT,EAAcC,WAAd,QAAiC,KAAjC;AAEA,SAASC,EAAT,QAAmB,oBAAnB;AACA,SAASC,UAAT,EAAqBC,UAArB,EAAiCC,KAAjC,EAAwCC,KAAxC,QAAqD,oBAArD;;AAEA,MAAMC,aAAa,GAAG,CAACC,CAAD,EAAIC,CAAJ,KAAU;EAC5B,MAAMC,SAAS,GAAGV,GAAG,CAAC,IAAD,CAArB;EAEA,IAAIW,MAAM,GAAGR,UAAU,CAACD,EAAD,EAAKM,CAAL,CAAvB;;EAEA,IAAIC,CAAJ,EAAO;IACHE,MAAM,GAAGN,KAAK,CAACM,MAAD,EAASL,KAAK,CAAC,GAAGG,CAAJ,CAAd,CAAd;EACH;;EAED,MAAMG,KAAK,GAAGR,UAAU,CAACO,MAAD,EAASE,QAAQ,IAAI;IACzC,IAAIC,OAAO,GAAG,EAAd;IACAD,QAAQ,CAACE,IAAT,CAAcC,OAAd,CAAsBC,GAAG,IAAI;MACzBH,OAAO,CAACI,IAAR,CAAa,EAAE,GAAGD,GAAG,CAACE,IAAJ,EAAL;QAAiBC,EAAE,EAAEH,GAAG,CAACG;MAAzB,CAAb;IACH,CAFD,EAFyC,CAMzC;;IACAV,SAAS,CAACW,KAAV,GAAkBP,OAAlB;EACH,CARuB,CAAxB;EAUAb,WAAW,CAAEqB,YAAD,IAAkB;IAC1BA,YAAY,CAAC,MAAMV,KAAK,EAAZ,CAAZ;EACH,CAFU,CAAX;EAIA,OAAO;IAAEF;EAAF,CAAP;AACH,CAxBD;;AA0BA,eAAeH,aAAf"},"metadata":{},"sourceType":"module"}